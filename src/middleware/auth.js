const API_KEYS = {
    "XALAP_CBRIT": "aB3dEfG7hI9", 
    "XALAP_BRUNO": "YWvLe1X5CU", 
    "XALAP_ANIMA": "jK2lMnOp4Q6", 
    "XALAP_JARDI": "rS8tUvWxY0z", 
    "XALAP_XSACE": "bC1dE2fG3hI", 
    "XALAP_AMERI": "jK4lM5nO6pQ", 
    "XALAP_COAT4": "rS7tU8vW9xY", 
    "XALAP_COAT1": "zA0bC1dE2fG", 
    "XALAP_ATENA": "hI3jK4lM5nO", 
    "XALAP_ROTON": "pQ6rS7tU8vW", 
    "XALAP_FUENT": "xY9zA0bC1dE", 
    "XALAP_CIRCU": "fG3hI4jK5lM", 
    "XALAP_PENAS": "nO6pQ7rS8tU", 
    "XALAP_XLUZB": "vW9xY0zA1bC", 
    "XALAP_TRANC": "dE2fG3hI4jK", 
    "XALAP_KRIST": "lM5nO6pQ7rS", 
    "XALAP_XALAP": "tU8vW9xY0zA", 
    "XALAP_BANDE": "bC1dE2fG3hI", 
    "XALAP_ORQUI": "jK4lM5nO6pQ", 
    "XALAP_CLAVI": "rS7tU8vW9xY", 
    "XALAP_RUIZC": "zA0bC1dE2fG", 
    "XALAP_ARCOS": "hI3jK4lM5nO", 
    "XALAP_REBSA": "pQ6rS7tU8vW", 
    "XALAP_XMONT": "xY9zA0bC1dE", 
    "XALAP_MURIL": "fG3hI4jK5lM", 
    "XALAP_XSUMI": "nO6pQ7rS8tU", 
    "XALAP_ACTOP": "vW9xY0zA1bC", 
    "XALAP_XICOC": "dE2fG3hI4jK", 
    "XALAP_ARAUC": "lM5nO6pQ7rS", 
    "XALAP_XRESE": "tU8vW9xY0zA", 
    "XALAP_XVIGA": "bC1dE2fG3hI", 
    "XALAP_XRAFA": "jK4lM5nO6pQ", 
    "XALAP_CAMPO": "rS7tU8vW9xY", 
    "XALAP_XXANA": "zA0bC1dE2fG", 
    "XALAP_ALTOL": "hI3jK4lM5nO", 
    "XALAP_MANAN": "pQ6rS7tU8vW", 
    "XALAP_TEOCE": "xY9zA0bC1dE", 
    "XALAP_CONGR": "fG3hI4jK5lM", 
    "XALAP_XPRAD": "nO6pQ7rS8tU", 
    "XALAP_XALA2": "vW9xY0zA1bC", 
    "XALAP_XCAST": "dE2fG3hI4jK", 
    "XALAP_COAT2": "lM5nO6pQ7rS", 
    "XALAP_PRESI": "tU8vW9xY0zA", 
    "XALAP_COSAU": "bC1dE2fG3hI", 
    "XALAP_MARZO": "jK4lM5nO6pQ", 
    "XALAP_MIRAD": "rS7tU8vW9xY", 
    "XALAP_XMIGU": "zA0bC1dE2fG", 
    "XALAP_XCOAP": "hI3jK4lM5nO", 
    "XALAP_XCOAC": "pQ6rS7tU8vW", 
    "XALAP_20NOV": "xY9zA0bC1dE", 
    "XALAP_RINCO": "fG3hI4jK5lM", 
    "XALAP_XPANI": "nO6pQ7rS8tU", 
    "XALAP_EBANO": "vW9xY0zA1bC", 
    "XALAP_ATEN2": "dE2fG3hI4jK", 
    "XALAP_CAROL": "lM5nO6pQ7rS", 
    "XALAP_TOTUT": "tU8vW9xY0zA", 
    "XALAP_ARBOL": "bC1dE2fG3hI", 
    "XALAP_CARRI": "jK4lM5nO6pQ", 
    "XALAP_AVILA": "rS7tU8vW9xY", 
    "XALAP_REVOL": "zA0bC1dE2fG", 
    "XALAP_XTUZA": "hI3jK4lM5nO", 
    "XALAP_CENAB": "pQ6rS7tU8vW", 
    "XALAP_20NO2": "xY9zA0bC1dE", 
    "XALAP_XMART": "fG3hI4jK5lM", 
    "XALAP_JILOT": "nO6pQ7rS8tU", 
    "XALAP_XJOSE": "vW9xY0zA1bC", 
    "XALAP_XXICB": "dE2fG3hI4jK", 
    "XALAP_TAUTO": "lM5nO6pQ7rS", 
    "XALAP_LUCIO": "tU8vW9xY0zA", 
    "XALAP_PENA2": "bC1dE2fG3hI", 
    "XALAP_XTLAL": "jK4lM5nO6pQ", 
    "XALAP_XESTA": "rS7tU8vW9xY", 
    "XALAP_AUTO2": "zA0bC1dE2fG", 
    "XALAP_COAT5": "hI3jK4lM5nO", 
    "XALAP_HIGUE": "pQ6rS7tU8vW", 
    "XALAP_XJALC": "xY9zA0bC1dE",  
    "XALAP_XJOYA": "fG3hI4jK5lM", 
    "XALAP_AUTO3": "nO6pQ7rS8tU", 
    "XALAP_XPUEN": "vW9xY0zA1bC", 
    "XALAP_XSANM": "dE2fG3hI4jK", 
    "XALAP_XAUTD": "lM5nO6pQ7rS", 
    "XALAP_MEVAB": "tU8vW9xY0zA",
    "XALAP_ELJUG": "fU9vW9xY0zA",
    "XALAP_DUMMY": "LWDSDxN2tH",
}
  
  const authMiddleware = (req, res, next) => {
    const apiKey = req.header('X-API-Key');
    
    if (!apiKey) {
      return res.status(401).json({
        status: "error",
        msg: "API Key requerida",
        status_id: "MISSING_API_KEY"
      });
    }
  
    // Buscar qué client_id tiene esta API Key
    const client_id = Object.keys(API_KEYS).find(key => API_KEYS[key] === apiKey);
    
    if (!client_id) {
      return res.status(401).json({
        status: "error",
        msg: "API Key inválida",
        status_id: "INVALID_API_KEY"
      });
    }
  
    req.client = { client_id };
    next();
  };
  
  module.exports = authMiddleware;