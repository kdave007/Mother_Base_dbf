services:
  api:
    build: .
    ports:
      - "3000:3000"
    environment:
      - REDIS_HOST=redis           # ← Redis DENTRO de Docker
      - PG_HOST=host.docker.internal  # ← PostgreSQL FUERA de Docker (tu máquina)
      - PG_PORT=5432
      - PG_DATABASE=shadow_moses
      - PG_USER=postgres
      - PG_PASSWORD=comexcare
    depends_on:
      - redis
    volumes:
      - ./logs:/app/logs  # ← Esto mapea ./logs local a /app/logs en el contenedor
    extra_hosts:
      - "host.docker.internal:host-gateway"  # ← Magic para conectar al host

  redis:
    image: redis:7-alpine    # ← Redis SÍ en contenedor
    ports:
      - "6379:6379"